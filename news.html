<!DOCTYPE html>
<!-- News page for Yokai eSports with live feed, archive, and search/filter UI -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Yokai eSports news, announcements, roster moves, and live updates." />
  <meta name="theme-color" content="#ff2e3c" />
  <title>Yokai eSports | News</title>
  <!-- Shared typography + base and page-specific styles -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Oswald:wght@500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/news.css">

</head>
<body>
  <!-- Primary site header with logo and top navigation -->
  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <button class="icon-button" aria-label="Open menu" data-drawer-toggle>‚ò∞</button>
        <a class="logo" href="index.html">YOKAI</a>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="teams.html">Teams</a></li>
        <li><a href="partners.html">Partners</a></li>
        <li><a href="#latest">Latest</a></li>
      </ul>
      <div class="header-actions">
        <button class="icon-button" ></button>
      </div>
    </div>
  </header>

  <!-- Mobile drawer navigation -->
  <aside class="drawer" data-drawer>
    <a class="logo" href="index.html">YOKAI</a>
    <a href="news.html">News</a>
    <a href="teams.html">Teams</a>
    <a href="content.html">Content</a>
    <a href="shop.html">Shop</a>
    <a href="partners.html">Partners</a>
    <div class="drawer-section">
      <a href="jobs.html">Jobs</a>
      <a href="contactPage.html">Contact</a>
      <a href="help.html">Help</a>
      <a href="termsOfServices.html" target="_blank">Terms</a>
      <a href="privacyPolicy.html" target="_blank">Privacy</a>
    </div>
    
  </aside>

  <div class="page">
    <!-- Hero banner -->
    <section class="hero" data-hero>
      <div class="hero-content">
        <span class="eyebrow">Live from the dojo</span>
        <h1>Yokai Newsroom</h1>
        <p>Roster moves, scrim highlights, and announcements‚Äîcurated and refreshed automatically.</p>
        <div class="button-row">
          <a class="btn primary" href="#latest">See latest updates</a>
          <a class="btn outline" href="#archive">Browse the archive</a>
        </div>
      </div>
    </section>

    <!-- Latest feed with search and filters -->
    <section id="latest" class="section">
      <div class="section-header">
        <h2>Latest feed</h2>
        <span class="muted">Pulled from our social + newsroom.</span>
      </div>
      <div class="search">
        <span>üîç</span>
        <input id="newsSearch" type="search" placeholder="Search announcements, roster moves, scrims..." aria-label="Search news">
      </div>
      <div class="two-col" style="margin-top:20px;">
        <div class="grid" id="latestNews">
          <!-- Static seed cards; replaced when live tweets load -->
          <article class="card news-card reveal" data-news-card data-tags="valorant roster">
            <span class="tag">Valorant</span>
            <h3>Valorant roster locks in for Split 1</h3>
            <p>Core four stays, with a new IGL to sharpen mid-round calls.</p>
            <div class="news-meta"><time datetime="2025-01-05">Jan 5, 2025</time><span class="badge">Roster</span></div>
          </article>
          <article class="card news-card reveal" data-news-card data-tags="cs2 tournament">
            <span class="tag">CS2</span>
            <h3>CS2 squad heads to Qualifiers</h3>
            <p>Bootcamp complete. We‚Äôre entering the open bracket with a 70% scrim win rate.</p>
            <div class="news-meta"><time datetime="2025-01-02">Jan 2, 2025</time><span class="badge">Tournament</span></div>
          </article>
          <article class="card news-card reveal" data-news-card data-tags="content video">
            <span class="tag">Content</span>
            <h3>New VOD review series drops weekly</h3>
            <p>Coaches break down executes, defaults, and clutch protocols from recent matches.</p>
            <div class="news-meta"><time datetime="2024-12-28">Dec 28, 2024</time><span class="badge">Video</span></div>
          </article>
        </div>
        <div class="card reveal">
          <h3>Filters</h3>
          <div class="pill-rail" id="filters">
            <button class="btn outline" data-filter="all">All</button>
            <button class="btn outline" data-filter="valorant">Valorant</button>
            <button class="btn outline" data-filter="cs2">CS2</button>
            <button class="btn outline" data-filter="roster">Roster</button>
            <button class="btn outline" data-filter="content">Content</button>
          </div>
          <p class="muted">Pro tip: use search + filters together to narrow down announcements.</p>
          <div class="button-row">
            <a class="btn primary" href="https://x.com/YokaieSportGG" target="_blank" rel="noreferrer">Follow on X ‚Üí</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Archived stories -->
    <section id="archive" class="section">
      <div class="section-header">
        <h2>Archive</h2>
        <span class="muted">Older drops still worth a read.</span>
      </div>
      <div class="grid" id="archiveGrid">
        <article class="card news-card reveal" data-news-card data-tags="valorant scrims">
          <span class="tag">Valorant</span>
          <h3>Scrim block vs top 16 wraps</h3>
          <p>New bind exec pays off‚Äî4/5 wins this block.</p>
          <div class="news-meta"><time datetime="2024-12-12">Dec 12, 2024</time><span class="badge">Scrims</span></div>
        </article>
        <article class="card news-card reveal" data-news-card data-tags="cs2 content">
          <span class="tag">CS2</span>
          <h3>Utility bible update</h3>
          <p>Our coaches dropped fresh CT side setups and execs for Mirage.</p>
          <div class="news-meta"><time datetime="2024-12-01">Dec 1, 2024</time><span class="badge">Guide</span></div>
        </article>
        <article class="card news-card reveal" data-news-card data-tags="community charity">
          <span class="tag">Community</span>
          <h3>Charity stream clears target</h3>
          <p>Raised funds for local STEM programs‚Äîthank you for showing up.</p>
          <div class="news-meta"><time datetime="2024-11-20">Nov 20, 2024</time><span class="badge">Community</span></div>
        </article>
      </div>
    </section>
  </div>

  <!-- Simple footer attribution -->
  <footer class="footer">
    Copyright ¬© 2025 Yokai eSports ‚Äî Designed by Thomas Peters
  </footer>

  <script src="scripts/main.js"></script>
  <script>
    const searchInput = document.getElementById('newsSearch');
    const filterButtons = document.querySelectorAll('#filters .btn');

    // Normalize text to lowercase to simplify comparisons
    function normalize(text) {
      return text.toLowerCase();
    }

    // Applies search query + active filter to all news cards
    function filterCards() {
      const query = normalize(searchInput.value.trim());
      const activeFilter = document.querySelector('#filters .btn.active')?.dataset.filter || 'all';
      const cards = document.querySelectorAll('[data-news-card]');

      cards.forEach(card => {
        const text = normalize(card.innerText);
        const tags = normalize(card.dataset.tags || '');
        const matchesQuery = !query || text.includes(query);
        const matchesFilter = activeFilter === 'all' || tags.includes(activeFilter);
        card.style.display = matchesQuery && matchesFilter ? '' : 'none';
      });
    }

    searchInput?.addEventListener('input', filterCards);
    filterButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        filterButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filterCards();
      });
    });

    // Start with "All" selected and apply initial filter state
    filterButtons[0]?.classList.add('active');
    filterCards();

    // Fetch live tweets from the backend and hydrate the latest feed
    async function loadTweets() {
      const container = document.getElementById('latestNews');
      try {
        const res = await fetch('/api/tweets');
        if (!res.ok) throw new Error('Bad response');
        const data = await res.json();
        if (!data.tweets || !Array.isArray(data.tweets) || !data.tweets.length) return;
        container.innerHTML = '';
        data.tweets.forEach((tweet) => {
          const card = document.createElement('article');
          card.className = 'card news-card reveal';
          card.dataset.newsCard = 'true';
          card.dataset.tags = 'social';
          card.innerHTML = `
            <span class="tag">Live</span>
            <h3>${tweet.text}</h3>
            <p class="news-meta" style="margin:0;"><a class="cta" href="https://x.com/${tweet.username}/status/${tweet.id}" target="_blank" rel="noreferrer">View on X ‚Üí</a></p>
          `;
          container.appendChild(card);
        });
      } catch (err) {
        console.error('Failed to load tweets', err);
      }
    }

    loadTweets();
  </script>
</body>
</html>
